<div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-8">
  <div class="container mx-auto px-4">
    <!-- Header du formulaire -->
    <div class="bg-slate-800/50 backdrop-blur-sm rounded-xl border border-purple-500/20 p-6 mb-8">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-4">
          <div class="w-12 h-12 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center">
            <span class="text-2xl">🚀</span>
          </div>
          <div>
            <h1 class="text-3xl font-bold text-white">Créer une Session</h1>
            <p class="text-gray-400">Configure ta prochaine session de jeu épique !</p>
          </div>
        </div>
        <button
          (click)="onCancel()"
          class="cancel-btn"
          type="button">
          <span class="mr-2">✕</span>
          Annuler
        </button>
      </div>
    </div>

    <!-- Formulaire principal -->
    <form (ngSubmit)="onSubmit()" class="space-y-8">

      <!-- Section Date et Heure -->
      <div class="form-section">
        <h2 class="section-title">
          <span class="mr-3">📅</span>
          Quand jouer ?
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Date de début -->
          <div class="form-group">
            <label for="startDate" class="form-label">
              <span class="mr-2">📆</span>
              Date de début
            </label>
            <input
              id="startDate"
              type="date"
              [field]="sessionForm.startDate"
              class="form-input"
              [class.error]="isFieldInvalid('startDate')">
            @if (isFieldInvalid('startDate')) {
              <div class="error-message">
                📍 La date est obligatoire
              </div>
            }
          </div>

          <!-- Heure de début -->
          <div class="form-group">
            <label for="startTime" class="form-label">
              <span class="mr-2">⏰</span>
              Heure de début
            </label>
            <input
              id="startTime"
              type="time"
              [field]="sessionForm.startTime"
              class="form-input"
              [class.error]="isFieldInvalid('startTime')">
            @if (isFieldInvalid('startTime')) {
              <div class="error-message">
                📍 L'heure est obligatoire
              </div>
            }
          </div>
        </div>
      </div>

      <!-- Section Amis -->
      <div class="form-section">
        <div class="flex items-center justify-between mb-6">
          <h2 class="section-title">
            <span class="mr-3">👥</span>
            Qui va jouer ?
          </h2>
          <button
            type="button"
            (click)="addFriend()"
            class="add-btn">
            <span class="mr-2">➕</span>
            Ajouter un ami
          </button>
        </div>

        <div  class="space-y-4">
          @for (friend of sessionForm.friends; track friend; let i = $index) {
            <div
              class="friend-card">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold text-white flex items-center">
                  <span class="mr-2">🎮</span>
                  Joueur {{ i + 1 }}
                </h3>
                @if (friendsArray.length > 1) {
                  <button
                    type="button"
                    (click)="removeFriend(i)"
                    class="remove-btn">
                    <span>🗑️</span>
                  </button>
                }
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Surnom -->
                <div class="form-group">
                  <label [for]="'surname-' + i" class="form-label">
                    <span class="mr-2">🏷️</span>
                    Surnom
                  </label>
                  <input
                    [id]="'surname-' + i"
                    type="text"
                    [field]="friend.surname"
                    placeholder="ex: DragonSlayer"
                    class="form-input"
                    [class.error]="isArrayFieldInvalid('friends', i, 'surname')">
                  @if (isArrayFieldInvalid('friends', i, 'surname')) {
                    <div class="error-message">
                      📍 Le surnom est obligatoire (min. 2 caractères)
                    </div>
                  }
                </div>
                <!-- Prénom -->
                <div class="form-group">
                  <label [for]="'firstname-' + i" class="form-label">
                    <span class="mr-2">👤</span>
                    Prénom
                  </label>
                  <input
                    [id]="'firstname-' + i"
                    type="text"
                    [field]="friend.firstname"
                    placeholder="ex: Alex"
                    class="form-input"
                    [class.error]="isArrayFieldInvalid('friends', i, 'firstname')">
                  @if (isArrayFieldInvalid('friends', i, 'firstname')) {
                    <div class="error-message">
                      📍 Le prénom est obligatoire (min. 2 caractères)
                    </div>
                  }
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Section Jeu -->      <div class="form-section">
      <h2 class="section-title">
        <span class="mr-3">🎮</span>
        À quel jeu jouer ?
      </h2>

      <div class="game-card">
        <div class="flex items-center mb-4">
          <h3 class="text-lg font-bold text-white flex items-center">
            <span class="mr-2">🕹️</span>
            Sélection du jeu
          </h3>
        </div>

        <div class="grid grid-cols-1 gap-4">
          <!-- Sélection du jeu -->
          <div class="form-group">
            <label for="gameName" class="form-label">
              <span class="mr-2">🎯</span>
              Choisir un jeu
            </label>
            <select
              id="gameName"
              [field]="sessionForm.gameName"
              class="form-input game-select"
              [class.error]="isFieldInvalid('gameName')">
              <option value="">Sélectionne ton jeu...</option>
              @for (category of gameCategories; track category) {
                <optgroup [label]="category.label">
                  @for (game of getGamesByCategory(category.value); track game) {
                    <option
                      [value]="game.name"
                      [attr.data-category]="game.category">
                      {{ game.icon }} {{ game.name }}
                    </option>
                  }
                </optgroup>
              }
            </select>
            @if (isFieldInvalid('gameName')) {
              <div class="error-message">
                📍 Sélectionne un jeu pour ta session
              </div>
            }

            <!-- Info sur le jeu sélectionné -->
            @if (getValueOfField('gameName')) {
              <div class="game-info">
                <span class="game-selected-indicator">
                  ✨ Parfait ! Prêt pour une session épique !
                </span>
              </div>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="form-section">
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <button
          type="button"
          (click)="onCancel()"
          class="cancel-btn-large"
          [disabled]="isSubmitting()">
          <span class="mr-2">↩️</span>
          Retour
        </button>

        <button
          type="submit"
          class="submit-btn"
          [disabled]="isSubmitting()">
          @if (!isSubmitting()) {
            <span class="mr-2">🚀</span>
          }
          @if (isSubmitting()) {
            <span class="mr-2 animate-spin">⚡</span>
          }
          {{ isSubmitting() ? 'Création en cours...' : 'Créer la Session' }}
        </button>
      </div>
    </div>
  </form>
</div>
</div>
